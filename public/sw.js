function servePhoto(e){let t=e.url.replace(/^(\d+-?)+\d+$\.jpg$/,"");return caches.open(DBHelper.contentImgsCache).then(function(s){s.match(t);return s.match(t).then(function(n){return n||fetch(e).then(function(e){return s.put(t,e.clone()),e}).then(e=>e||caches.match("/img/static/placeholder.png")).catch(e=>(e.message=`Request failed serve request. Returned status of ${e.message}`,caches.match("/img/static/placeholder.png")))})}).catch(e=>{throw e.message=`Request failed serve photo. Returned status of ${e.message}`,e})}function serveRequest(e){let t=e.url;return caches.open(staticCacheName).then(function(s){return s.match(t).then(function(n){return n||fetch(e).then(function(e){return s.put(t,e.clone()),e}).catch(e=>(e.message=`Request failed serve request. Returned status of ${e.message}`,caches.match("/404.html")))})}).catch(e=>{throw e.message=`Request failed. Returned status of ${e.message} - sw-serveRequest()-catch`,e})}function serveJSON(e){if(!navigator.onLine){const t=getParameterByName("id",e.url);return new Promise((e,s)=>{t?DBHelper.getRestaurantById(t,(n,a)=>{n&&s(n),e(t,a)}):e(t,!1)}).then((e,t)=>e&&t?t:!e&&new Promise((e,t)=>{const s=!navigator.onLine;DBHelper.getAllRestaurants(s,(s,n)=>{s&&t(s),e(n)})}).then(e=>!!(e&&e.length>0)&&e)).then(e=>e?JSON.stringify(e):JSON.stringify([])).catch(e=>(e.message=`Request failed. Returned status of ${e.message} - sw-serveJSON()-catch`,JSON.stringify([])))}return fetch(e,{headers:{"Content-Type":"application/json"}}).then(function(e){return e}).then(e=>e.json()).catch(e=>(e.message=`Request failed. Returned status of ${e.message} - sw-serveJSON`,e))}function getParameterByName(e,t){if(!t)return!1;e=e.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}function cleanCache(){return caches.keys().then(function(e){return Promise.all(e.filter(function(e){return e.startsWith(appPrefix)&&!allCaches.includes(e)}).map(function(e){return caches.delete(e)}))}).catch(e=>{throw e.message=`Request failed clean cache. Returned status of ${e.message} -sw-cleanCache()`,e})}self.importScripts("js/idb.js"),self.importScripts("js/dbhelper.min.js"),self.addEventListener("install",function(e){self.skipWaiting(),e.waitUntil(caches.open(DBHelper.staticCacheName).then(function(e){return e.addAll(["/css/main.min.css","/js/regular.js","/js/fontawesome.js","/js/main.min.js","/js/dbhelper.min.js","/js/idb.js","/js/index.min.js","/js/restaurant.min.js","/404.html","/index.html","/manifest.json","/robots.txt","/sw.js","https://fonts.googleapis.com/css?family=Roboto","https://fonts.googleapis.com/css?family=Roboto:300,400,500,700","https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxK.woff2","https://fonts.gstatic.com/s/roboto/v18/KFOlCnqEu92Fr1MmEU9fBBc4.woff2"])}).then(e=>{caches.open(DBHelper.contentImgsCache).then(function(e){return e.addAll(["/img/icons/icon.png","/img/icons/icon192.png","/img/icons/icon512.png","/img/320/1.jpg","/img/320/2.jpg","/img/320/3.jpg","/img/320/4.jpg","/img/320/5.jpg","/img/320/6.jpg","/img/320/7.jpg","/img/320/8.jpg","/img/320/9.jpg","/img/320/10.jpg","/img/placeholder.png"])}).then(e=>!0)}).catch(e=>{throw e.message=`Request failed. Returned status of ${e.message} - sw-install()`,e}))}),self.addEventListener("activate",function(e){e.waitUntil(cleanCache().catch(e=>(e.message=`Request failed. Returned status of ${e.message} - sw-activate()`,!1)))}),self.addEventListener("fetch",function(e){const t=new URL(e.request.url);if("1337"===t.port){const e=serveJSON(t);if(e)return e}else if(t.origin===location.origin){if(""===t.pathname||"/"===t.pathname){caches.match("/index.html");return void e.respondWith(caches.match("/index.html").catch(e=>(e.message=`Request failed serve request. Returned status of ${e.message} - sw-addEventListener()-fetch`,caches.match("/404.html"))))}if(t.pathname.indexOf("img/")>0)return void e.respondWith(servePhoto(e.request))}e.respondWith(serveRequest(e.request))});